syntax = "proto3";

package grafeas.v1;

import "google/api/field_behavior.proto";
import "google/protobuf/timestamp.proto";
import "grafeas/v1/common.proto";
import "grafeas/v1/cvss.proto";
import "grafeas/v1/package.proto";

option java_package = "io.grafeas.v1";
option java_multiple_files = true;
option go_package = "google.golang.org/genproto/googleapis/grafeas/v1;grafeas";
option objc_class_prefix = "GRA";


enum Severity {

	SEVERITY_UNSPECIFIED = 0;
	MINIMAL = 1;
	LOW = 2;
	MEDIUM = 3;
	HIGH = 4;
	CRITICAL = 5;
}

message VulnerabilityNote {

	message Detail {

		string severity_name = 1;
		string description = 2;
		string package_type = 3;
		string affected_cpe_uri = 4;
		string affected_package = 5;
		grafeas.v1.Version affected_version_start = 6;
		grafeas.v1.Version affected_version_end = 7;
		string fixed_cpe_uri = 8;
		string fixed_package = 9;
		grafeas.v1.Version fixed_version = 10;
		bool is_obsolete = 11;
		google.protobuf.Timestamp source_update_time = 12;
		string source = 13;
		string vendor = 14;
	}

	message WindowsDetail {

		message KnowledgeBase {

			string name = 1;
			string url = 2;
		}

		string cpe_uri = 1;
		string name = 2;
		string description = 3;
		repeated KnowledgeBase fixing_kbs = 4;
	}

	float cvss_score = 1;
	Severity severity = 2;
	repeated Detail details = 3;
	grafeas.v1.CVSSv3 cvss_v3 = 4;
	repeated WindowsDetail windows_details = 5;
	google.protobuf.Timestamp source_update_time = 6;
}

message VulnerabilityOccurrence {

	message CVSSV3 {

		float base_score = 1;
		Severity severity = 2;
	}

	message PackageIssue {

		string affected_cpe_uri = 1;
		string affected_package = 2;
		grafeas.v1.Version affected_version = 3;
		string fixed_cpe_uri = 4;
		string fixed_package = 5;
		grafeas.v1.Version fixed_version = 6;
		bool fix_available = 7;
		string package_type = 8;
		Severity effective_severity = 9 [
			(google.api.field_behavior) = OUTPUT_ONLY
		];
	}

	string type = 1;
	Severity severity = 2;
	float cvss_score = 3;
	CVSSV3 cvssv3 = 10;
	repeated PackageIssue package_issue = 4;
	string short_description = 5;
	string long_description = 6;
	repeated grafeas.v1.RelatedUrl related_urls = 7;
	Severity effective_severity = 8;
	bool fix_available = 9;
}
