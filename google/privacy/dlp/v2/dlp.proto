syntax = "proto3";

package google.privacy.dlp.v2;

import "google/api/client.proto";
import "google/api/field_behavior.proto";
import "google/api/resource.proto";
import "google/privacy/dlp/v2/storage.proto";
import "google/protobuf/duration.proto";
import "google/protobuf/empty.proto";
import "google/protobuf/field_mask.proto";
import "google/protobuf/timestamp.proto";
import "google/rpc/status.proto";
import "google/type/date.proto";
import "google/type/dayofweek.proto";
import "google/type/timeofday.proto";
import "google/api/annotations.proto";

option java_package = "com.google.privacy.dlp.v2";
option java_outer_classname = "DlpProto";
option java_multiple_files = true;
option go_package = "google.golang.org/genproto/googleapis/privacy/dlp/v2;dlp";
option csharp_namespace = "Google.Cloud.Dlp.V2";
option php_namespace = "Google\\Cloud\\Dlp\\V2";
option ruby_package = "Google::Cloud::Dlp::V2";
option (google.api.resource_definition) = {
	type: "dlp.googleapis.com/DlpContent"
	pattern: ["projects/{project}/dlpContent","projects/{project}/locations/{location}/dlpContent"]
};
option (google.api.resource_definition) = {
	type: "dlp.googleapis.com/OrganizationLocation"
	pattern: ["organizations/{organization}/locations/{location}"]
};


enum RelationalOperator {

	RELATIONAL_OPERATOR_UNSPECIFIED = 0;
	EQUAL_TO = 1;
	NOT_EQUAL_TO = 2;
	GREATER_THAN = 3;
	LESS_THAN = 4;
	GREATER_THAN_OR_EQUALS = 5;
	LESS_THAN_OR_EQUALS = 6;
	EXISTS = 7;
}

enum MatchingType {

	MATCHING_TYPE_UNSPECIFIED = 0;
	MATCHING_TYPE_FULL_MATCH = 1;
	MATCHING_TYPE_PARTIAL_MATCH = 2;
	MATCHING_TYPE_INVERSE_MATCH = 3;
}

enum ContentOption {

	CONTENT_UNSPECIFIED = 0;
	CONTENT_TEXT = 1;
	CONTENT_IMAGE = 2;
}

enum MetadataType {

	METADATATYPE_UNSPECIFIED = 0;
	STORAGE_METADATA = 2;
}

enum InfoTypeSupportedBy {

	ENUM_TYPE_UNSPECIFIED = 0;
	INSPECT = 1;
	RISK_ANALYSIS = 2;
}

enum DlpJobType {

	DLP_JOB_TYPE_UNSPECIFIED = 0;
	INSPECT_JOB = 1;
	RISK_ANALYSIS_JOB = 2;
}

enum StoredInfoTypeState {

	STORED_INFO_TYPE_STATE_UNSPECIFIED = 0;
	PENDING = 1;
	READY = 2;
	FAILED = 3;
	INVALID = 4;
}

service DlpService {
	option (google.api.default_host) = "dlp.googleapis.com";
	option (google.api.oauth_scopes) = "https://www.googleapis.com/auth/cloud-platform";

	rpc InspectContent(google.privacy.dlp.v2.InspectContentRequest) returns (google.privacy.dlp.v2.InspectContentResponse) {
		option (google.api.http) = {
			post: "/v2/{parent=projects/*}/content:inspect"
			body: "*"
			additional_bindings: {
				post: "/v2/{parent=projects/*/locations/*}/content:inspect"
				body: "*"
			}
		};

	}
	rpc RedactImage(google.privacy.dlp.v2.RedactImageRequest) returns (google.privacy.dlp.v2.RedactImageResponse) {
		option (google.api.http) = {
			post: "/v2/{parent=projects/*}/image:redact"
			body: "*"
			additional_bindings: {
				post: "/v2/{parent=projects/*/locations/*}/image:redact"
				body: "*"
			}
		};

	}
	rpc DeidentifyContent(google.privacy.dlp.v2.DeidentifyContentRequest) returns (google.privacy.dlp.v2.DeidentifyContentResponse) {
		option (google.api.http) = {
			post: "/v2/{parent=projects/*}/content:deidentify"
			body: "*"
			additional_bindings: {
				post: "/v2/{parent=projects/*/locations/*}/content:deidentify"
				body: "*"
			}
		};

	}
	rpc ReidentifyContent(google.privacy.dlp.v2.ReidentifyContentRequest) returns (google.privacy.dlp.v2.ReidentifyContentResponse) {
		option (google.api.http) = {
			post: "/v2/{parent=projects/*}/content:reidentify"
			body: "*"
			additional_bindings: {
				post: "/v2/{parent=projects/*/locations/*}/content:reidentify"
				body: "*"
			}
		};

	}
	rpc ListInfoTypes(google.privacy.dlp.v2.ListInfoTypesRequest) returns (google.privacy.dlp.v2.ListInfoTypesResponse) {
		option (google.api.method_signature) = "parent";
		option (google.api.http) = {
			get: "/v2/infoTypes"
			additional_bindings: {
				get: "/v2/{parent=locations/*}/infoTypes"
			}
		};

	}
	rpc CreateInspectTemplate(google.privacy.dlp.v2.CreateInspectTemplateRequest) returns (google.privacy.dlp.v2.InspectTemplate) {
		option (google.api.method_signature) = "parent,inspect_template";
		option (google.api.http) = {
			post: "/v2/{parent=organizations/*}/inspectTemplates"
			body: "*"
			additional_bindings: {
				post: "/v2/{parent=organizations/*/locations/*}/inspectTemplates"
				body: "*"
			}
			additional_bindings: {
				post: "/v2/{parent=projects/*}/inspectTemplates"
				body: "*"
			}
			additional_bindings: {
				post: "/v2/{parent=projects/*/locations/*}/inspectTemplates"
				body: "*"
			}
		};

	}
	rpc UpdateInspectTemplate(google.privacy.dlp.v2.UpdateInspectTemplateRequest) returns (google.privacy.dlp.v2.InspectTemplate) {
		option (google.api.method_signature) = "name,inspect_template,update_mask";
		option (google.api.http) = {
			patch: "/v2/{name=organizations/*/inspectTemplates/*}"
			body: "*"
			additional_bindings: {
				patch: "/v2/{name=organizations/*/locations/*/inspectTemplates/*}"
				body: "*"
			}
			additional_bindings: {
				patch: "/v2/{name=projects/*/inspectTemplates/*}"
				body: "*"
			}
			additional_bindings: {
				patch: "/v2/{name=projects/*/locations/*/inspectTemplates/*}"
				body: "*"
			}
		};

	}
	rpc GetInspectTemplate(google.privacy.dlp.v2.GetInspectTemplateRequest) returns (google.privacy.dlp.v2.InspectTemplate) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			get: "/v2/{name=organizations/*/inspectTemplates/*}"
			additional_bindings: {
				get: "/v2/{name=organizations/*/locations/*/inspectTemplates/*}"
			}
			additional_bindings: {
				get: "/v2/{name=projects/*/inspectTemplates/*}"
			}
			additional_bindings: {
				get: "/v2/{name=projects/*/locations/*/inspectTemplates/*}"
			}
		};

	}
	rpc ListInspectTemplates(google.privacy.dlp.v2.ListInspectTemplatesRequest) returns (google.privacy.dlp.v2.ListInspectTemplatesResponse) {
		option (google.api.method_signature) = "parent";
		option (google.api.http) = {
			get: "/v2/{parent=organizations/*}/inspectTemplates"
			additional_bindings: {
				get: "/v2/{parent=organizations/*/locations/*}/inspectTemplates"
			}
			additional_bindings: {
				get: "/v2/{parent=projects/*}/inspectTemplates"
			}
			additional_bindings: {
				get: "/v2/{parent=projects/*/locations/*}/inspectTemplates"
			}
		};

	}
	rpc DeleteInspectTemplate(google.privacy.dlp.v2.DeleteInspectTemplateRequest) returns (google.protobuf.Empty) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			delete: "/v2/{name=organizations/*/inspectTemplates/*}"
			additional_bindings: {
				delete: "/v2/{name=organizations/*/locations/*/inspectTemplates/*}"
			}
			additional_bindings: {
				delete: "/v2/{name=projects/*/inspectTemplates/*}"
			}
			additional_bindings: {
				delete: "/v2/{name=projects/*/locations/*/inspectTemplates/*}"
			}
		};

	}
	rpc CreateDeidentifyTemplate(google.privacy.dlp.v2.CreateDeidentifyTemplateRequest) returns (google.privacy.dlp.v2.DeidentifyTemplate) {
		option (google.api.method_signature) = "parent,deidentify_template";
		option (google.api.http) = {
			post: "/v2/{parent=organizations/*}/deidentifyTemplates"
			body: "*"
			additional_bindings: {
				post: "/v2/{parent=organizations/*/locations/*}/deidentifyTemplates"
				body: "*"
			}
			additional_bindings: {
				post: "/v2/{parent=projects/*}/deidentifyTemplates"
				body: "*"
			}
			additional_bindings: {
				post: "/v2/{parent=projects/*/locations/*}/deidentifyTemplates"
				body: "*"
			}
		};

	}
	rpc UpdateDeidentifyTemplate(google.privacy.dlp.v2.UpdateDeidentifyTemplateRequest) returns (google.privacy.dlp.v2.DeidentifyTemplate) {
		option (google.api.method_signature) = "name,deidentify_template,update_mask";
		option (google.api.http) = {
			patch: "/v2/{name=organizations/*/deidentifyTemplates/*}"
			body: "*"
			additional_bindings: {
				patch: "/v2/{name=organizations/*/locations/*/deidentifyTemplates/*}"
				body: "*"
			}
			additional_bindings: {
				patch: "/v2/{name=projects/*/deidentifyTemplates/*}"
				body: "*"
			}
			additional_bindings: {
				patch: "/v2/{name=projects/*/locations/*/deidentifyTemplates/*}"
				body: "*"
			}
		};

	}
	rpc GetDeidentifyTemplate(google.privacy.dlp.v2.GetDeidentifyTemplateRequest) returns (google.privacy.dlp.v2.DeidentifyTemplate) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			get: "/v2/{name=organizations/*/deidentifyTemplates/*}"
			additional_bindings: {
				get: "/v2/{name=organizations/*/locations/*/deidentifyTemplates/*}"
			}
			additional_bindings: {
				get: "/v2/{name=projects/*/deidentifyTemplates/*}"
			}
			additional_bindings: {
				get: "/v2/{name=projects/*/locations/*/deidentifyTemplates/*}"
			}
		};

	}
	rpc ListDeidentifyTemplates(google.privacy.dlp.v2.ListDeidentifyTemplatesRequest) returns (google.privacy.dlp.v2.ListDeidentifyTemplatesResponse) {
		option (google.api.method_signature) = "parent";
		option (google.api.http) = {
			get: "/v2/{parent=organizations/*}/deidentifyTemplates"
			additional_bindings: {
				get: "/v2/{parent=organizations/*/locations/*}/deidentifyTemplates"
			}
			additional_bindings: {
				get: "/v2/{parent=projects/*}/deidentifyTemplates"
			}
			additional_bindings: {
				get: "/v2/{parent=projects/*/locations/*}/deidentifyTemplates"
			}
		};

	}
	rpc DeleteDeidentifyTemplate(google.privacy.dlp.v2.DeleteDeidentifyTemplateRequest) returns (google.protobuf.Empty) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			delete: "/v2/{name=organizations/*/deidentifyTemplates/*}"
			additional_bindings: {
				delete: "/v2/{name=organizations/*/locations/*/deidentifyTemplates/*}"
			}
			additional_bindings: {
				delete: "/v2/{name=projects/*/deidentifyTemplates/*}"
			}
			additional_bindings: {
				delete: "/v2/{name=projects/*/locations/*/deidentifyTemplates/*}"
			}
		};

	}
	rpc CreateJobTrigger(google.privacy.dlp.v2.CreateJobTriggerRequest) returns (google.privacy.dlp.v2.JobTrigger) {
		option (google.api.method_signature) = "parent,job_trigger";
		option (google.api.http) = {
			post: "/v2/{parent=projects/*}/jobTriggers"
			body: "*"
			additional_bindings: {
				post: "/v2/{parent=projects/*/locations/*}/jobTriggers"
				body: "*"
			}
		};

	}
	rpc UpdateJobTrigger(google.privacy.dlp.v2.UpdateJobTriggerRequest) returns (google.privacy.dlp.v2.JobTrigger) {
		option (google.api.method_signature) = "name,job_trigger,update_mask";
		option (google.api.http) = {
			patch: "/v2/{name=projects/*/jobTriggers/*}"
			body: "*"
			additional_bindings: {
				patch: "/v2/{name=projects/*/locations/*/jobTriggers/*}"
				body: "*"
			}
		};

	}
	rpc HybridInspectJobTrigger(google.privacy.dlp.v2.HybridInspectJobTriggerRequest) returns (google.privacy.dlp.v2.HybridInspectResponse) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			post: "/v2/{name=projects/*/locations/*/jobTriggers/*}:hybridInspect"
			body: "*"
		};

	}
	rpc GetJobTrigger(google.privacy.dlp.v2.GetJobTriggerRequest) returns (google.privacy.dlp.v2.JobTrigger) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			get: "/v2/{name=projects/*/jobTriggers/*}"
			additional_bindings: {
				get: "/v2/{name=projects/*/locations/*/jobTriggers/*}"
			}
		};

	}
	rpc ListJobTriggers(google.privacy.dlp.v2.ListJobTriggersRequest) returns (google.privacy.dlp.v2.ListJobTriggersResponse) {
		option (google.api.method_signature) = "parent";
		option (google.api.http) = {
			get: "/v2/{parent=projects/*}/jobTriggers"
			additional_bindings: {
				get: "/v2/{parent=projects/*/locations/*}/jobTriggers"
			}
		};

	}
	rpc DeleteJobTrigger(google.privacy.dlp.v2.DeleteJobTriggerRequest) returns (google.protobuf.Empty) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			delete: "/v2/{name=projects/*/jobTriggers/*}"
			additional_bindings: {
				delete: "/v2/{name=projects/*/locations/*/jobTriggers/*}"
			}
		};

	}
	rpc ActivateJobTrigger(google.privacy.dlp.v2.ActivateJobTriggerRequest) returns (google.privacy.dlp.v2.DlpJob) {
		option (google.api.http) = {
			post: "/v2/{name=projects/*/jobTriggers/*}:activate"
			body: "*"
			additional_bindings: {
				post: "/v2/{name=projects/*/locations/*/jobTriggers/*}:activate"
				body: "*"
			}
		};

	}
	rpc CreateDlpJob(google.privacy.dlp.v2.CreateDlpJobRequest) returns (google.privacy.dlp.v2.DlpJob) {
		option (google.api.method_signature) = "parent,inspect_job";
		option (google.api.method_signature) = "parent,risk_job";
		option (google.api.http) = {
			post: "/v2/{parent=projects/*}/dlpJobs"
			body: "*"
			additional_bindings: {
				post: "/v2/{parent=projects/*/locations/*}/dlpJobs"
				body: "*"
			}
		};

	}
	rpc ListDlpJobs(google.privacy.dlp.v2.ListDlpJobsRequest) returns (google.privacy.dlp.v2.ListDlpJobsResponse) {
		option (google.api.method_signature) = "parent";
		option (google.api.http) = {
			get: "/v2/{parent=projects/*}/dlpJobs"
			additional_bindings: {
				get: "/v2/{parent=projects/*/locations/*}/dlpJobs"
			}
		};

	}
	rpc GetDlpJob(google.privacy.dlp.v2.GetDlpJobRequest) returns (google.privacy.dlp.v2.DlpJob) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			get: "/v2/{name=projects/*/dlpJobs/*}"
			additional_bindings: {
				get: "/v2/{name=projects/*/locations/*/dlpJobs/*}"
			}
		};

	}
	rpc DeleteDlpJob(google.privacy.dlp.v2.DeleteDlpJobRequest) returns (google.protobuf.Empty) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			delete: "/v2/{name=projects/*/dlpJobs/*}"
			additional_bindings: {
				delete: "/v2/{name=projects/*/locations/*/dlpJobs/*}"
			}
		};

	}
	rpc CancelDlpJob(google.privacy.dlp.v2.CancelDlpJobRequest) returns (google.protobuf.Empty) {
		option (google.api.http) = {
			post: "/v2/{name=projects/*/dlpJobs/*}:cancel"
			body: "*"
			additional_bindings: {
				post: "/v2/{name=projects/*/locations/*/dlpJobs/*}:cancel"
				body: "*"
			}
		};

	}
	rpc CreateStoredInfoType(google.privacy.dlp.v2.CreateStoredInfoTypeRequest) returns (google.privacy.dlp.v2.StoredInfoType) {
		option (google.api.method_signature) = "parent,config";
		option (google.api.http) = {
			post: "/v2/{parent=organizations/*}/storedInfoTypes"
			body: "*"
			additional_bindings: {
				post: "/v2/{parent=organizations/*/locations/*}/storedInfoTypes"
				body: "*"
			}
			additional_bindings: {
				post: "/v2/{parent=projects/*}/storedInfoTypes"
				body: "*"
			}
			additional_bindings: {
				post: "/v2/{parent=projects/*/locations/*}/storedInfoTypes"
				body: "*"
			}
		};

	}
	rpc UpdateStoredInfoType(google.privacy.dlp.v2.UpdateStoredInfoTypeRequest) returns (google.privacy.dlp.v2.StoredInfoType) {
		option (google.api.method_signature) = "name,config,update_mask";
		option (google.api.http) = {
			patch: "/v2/{name=organizations/*/storedInfoTypes/*}"
			body: "*"
			additional_bindings: {
				patch: "/v2/{name=organizations/*/locations/*/storedInfoTypes/*}"
				body: "*"
			}
			additional_bindings: {
				patch: "/v2/{name=projects/*/storedInfoTypes/*}"
				body: "*"
			}
			additional_bindings: {
				patch: "/v2/{name=projects/*/locations/*/storedInfoTypes/*}"
				body: "*"
			}
		};

	}
	rpc GetStoredInfoType(google.privacy.dlp.v2.GetStoredInfoTypeRequest) returns (google.privacy.dlp.v2.StoredInfoType) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			get: "/v2/{name=organizations/*/storedInfoTypes/*}"
			additional_bindings: {
				get: "/v2/{name=organizations/*/locations/*/storedInfoTypes/*}"
			}
			additional_bindings: {
				get: "/v2/{name=projects/*/storedInfoTypes/*}"
			}
			additional_bindings: {
				get: "/v2/{name=projects/*/locations/*/storedInfoTypes/*}"
			}
		};

	}
	rpc ListStoredInfoTypes(google.privacy.dlp.v2.ListStoredInfoTypesRequest) returns (google.privacy.dlp.v2.ListStoredInfoTypesResponse) {
		option (google.api.method_signature) = "parent";
		option (google.api.http) = {
			get: "/v2/{parent=organizations/*}/storedInfoTypes"
			additional_bindings: {
				get: "/v2/{parent=organizations/*/locations/*}/storedInfoTypes"
			}
			additional_bindings: {
				get: "/v2/{parent=projects/*}/storedInfoTypes"
			}
			additional_bindings: {
				get: "/v2/{parent=projects/*/locations/*}/storedInfoTypes"
			}
		};

	}
	rpc DeleteStoredInfoType(google.privacy.dlp.v2.DeleteStoredInfoTypeRequest) returns (google.protobuf.Empty) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			delete: "/v2/{name=organizations/*/storedInfoTypes/*}"
			additional_bindings: {
				delete: "/v2/{name=organizations/*/locations/*/storedInfoTypes/*}"
			}
			additional_bindings: {
				delete: "/v2/{name=projects/*/storedInfoTypes/*}"
			}
			additional_bindings: {
				delete: "/v2/{name=projects/*/locations/*/storedInfoTypes/*}"
			}
		};

	}
	rpc HybridInspectDlpJob(google.privacy.dlp.v2.HybridInspectDlpJobRequest) returns (google.privacy.dlp.v2.HybridInspectResponse) {
		option (google.api.method_signature) = "name";
		option (google.api.http) = {
			post: "/v2/{name=projects/*/locations/*/dlpJobs/*}:hybridInspect"
			body: "*"
		};

	}
	rpc FinishDlpJob(google.privacy.dlp.v2.FinishDlpJobRequest) returns (google.protobuf.Empty) {
		option (google.api.http) = {
			post: "/v2/{name=projects/*/locations/*/dlpJobs/*}:finish"
			body: "*"
		};

	}
}

message ExcludeInfoTypes {

	repeated google.privacy.dlp.v2.InfoType info_types = 1;
}

message ExclusionRule {

	oneof type {
		google.privacy.dlp.v2.CustomInfoType.Dictionary dictionary = 1;
		google.privacy.dlp.v2.CustomInfoType.Regex regex = 2;
		ExcludeInfoTypes exclude_info_types = 3;
	}
	MatchingType matching_type = 4;
}

message InspectionRule {

	oneof type {
		google.privacy.dlp.v2.CustomInfoType.DetectionRule.HotwordRule hotword_rule = 1;
		ExclusionRule exclusion_rule = 2;
	}
}

message InspectionRuleSet {

	repeated google.privacy.dlp.v2.InfoType info_types = 1;
	repeated InspectionRule rules = 2;
}

message InspectConfig {

	message FindingLimits {

		message InfoTypeLimit {

			google.privacy.dlp.v2.InfoType info_type = 1;
			int32 max_findings = 2;
		}

		int32 max_findings_per_item = 1;
		int32 max_findings_per_request = 2;
		repeated InfoTypeLimit max_findings_per_info_type = 3;
	}

	repeated google.privacy.dlp.v2.InfoType info_types = 1;
	google.privacy.dlp.v2.Likelihood min_likelihood = 2;
	FindingLimits limits = 3;
	bool include_quote = 4;
	bool exclude_info_types = 5;
	repeated google.privacy.dlp.v2.CustomInfoType custom_info_types = 6;
	repeated ContentOption content_options = 8;
	repeated InspectionRuleSet rule_set = 10;
}

message ByteContentItem {

	enum BytesType {

		BYTES_TYPE_UNSPECIFIED = 0;
		IMAGE = 6;
		IMAGE_JPEG = 1;
		IMAGE_BMP = 2;
		IMAGE_PNG = 3;
		IMAGE_SVG = 4;
		TEXT_UTF8 = 5;
		WORD_DOCUMENT = 7;
		PDF = 8;
		AVRO = 11;
		CSV = 12;
		TSV = 13;
	}

	BytesType type = 1;
	bytes data = 2;
}

message ContentItem {

	oneof data_item {
		string value = 3;
		Table table = 4;
		ByteContentItem byte_item = 5;
	}
}

message Table {

	message Row {

		repeated Value values = 1;
	}

	repeated google.privacy.dlp.v2.FieldId headers = 1;
	repeated Row rows = 2;
}

message InspectResult {

	repeated Finding findings = 1;
	bool findings_truncated = 2;
}

message Finding {
	option (google.api.resource) = {
		type: "dlp.googleapis.com/Finding"
		pattern: ["projects/{project}/locations/{location}/findings/{finding}"]
	};

	string name = 14;
	string quote = 1;
	google.privacy.dlp.v2.InfoType info_type = 2;
	google.privacy.dlp.v2.Likelihood likelihood = 3;
	Location location = 4;
	google.protobuf.Timestamp create_time = 6;
	QuoteInfo quote_info = 7;
	string resource_name = 8 [
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/DlpJob"
		}
	];
	string trigger_name = 9 [
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/JobTrigger"
		}
	];
	map<string, string> labels = 10;
	google.protobuf.Timestamp job_create_time = 11;
	string job_name = 13 [
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/DlpJob"
		}
	];
}

message Location {

	Range byte_range = 1;
	Range codepoint_range = 2;
	repeated ContentLocation content_locations = 7;
	Container container = 8;
}

message ContentLocation {

	string container_name = 1;
	oneof location {
		RecordLocation record_location = 2;
		ImageLocation image_location = 3;
		DocumentLocation document_location = 5;
		MetadataLocation metadata_location = 8;
	}
	google.protobuf.Timestamp container_timestamp = 6;
	string container_version = 7;
}

message MetadataLocation {

	MetadataType type = 1;
	oneof label {
		StorageMetadataLabel storage_label = 3;
	}
}

message StorageMetadataLabel {

	string key = 1;
}

message DocumentLocation {

	int64 file_offset = 1;
}

message RecordLocation {

	google.privacy.dlp.v2.RecordKey record_key = 1;
	google.privacy.dlp.v2.FieldId field_id = 2;
	TableLocation table_location = 3;
}

message TableLocation {

	int64 row_index = 1;
}

message Container {

	string type = 1;
	string project_id = 2;
	string full_path = 3;
	string root_path = 4;
	string relative_path = 5;
	google.protobuf.Timestamp update_time = 6;
	string version = 7;
}

message Range {

	int64 start = 1;
	int64 end = 2;
}

message ImageLocation {

	repeated BoundingBox bounding_boxes = 1;
}

message BoundingBox {

	int32 top = 1;
	int32 left = 2;
	int32 width = 3;
	int32 height = 4;
}

message RedactImageRequest {

	message ImageRedactionConfig {

		oneof target {
			google.privacy.dlp.v2.InfoType info_type = 1;
			bool redact_all_text = 2;
		}
		Color redaction_color = 3;
	}

	string parent = 1 [
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/DlpContent"
		}
	];
	string location_id = 8;
	InspectConfig inspect_config = 2;
	repeated ImageRedactionConfig image_redaction_configs = 5;
	bool include_findings = 6;
	ByteContentItem byte_item = 7;
}

message Color {

	float red = 1;
	float green = 2;
	float blue = 3;
}

message RedactImageResponse {

	bytes redacted_image = 1;
	string extracted_text = 2;
	InspectResult inspect_result = 3;
}

message DeidentifyContentRequest {

	string parent = 1 [
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/DlpContent"
		}
	];
	DeidentifyConfig deidentify_config = 2;
	InspectConfig inspect_config = 3;
	ContentItem item = 4;
	string inspect_template_name = 5;
	string deidentify_template_name = 6;
	string location_id = 7;
}

message DeidentifyContentResponse {

	ContentItem item = 1;
	TransformationOverview overview = 2;
}

message ReidentifyContentRequest {

	string parent = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/DlpContent"
		}
	];
	DeidentifyConfig reidentify_config = 2;
	InspectConfig inspect_config = 3;
	ContentItem item = 4;
	string inspect_template_name = 5;
	string reidentify_template_name = 6;
	string location_id = 7;
}

message ReidentifyContentResponse {

	ContentItem item = 1;
	TransformationOverview overview = 2;
}

message InspectContentRequest {

	string parent = 1 [
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/DlpContent"
		}
	];
	InspectConfig inspect_config = 2;
	ContentItem item = 3;
	string inspect_template_name = 4;
	string location_id = 5;
}

message InspectContentResponse {

	InspectResult result = 1;
}

message OutputStorageConfig {

	enum OutputSchema {

		OUTPUT_SCHEMA_UNSPECIFIED = 0;
		BASIC_COLUMNS = 1;
		GCS_COLUMNS = 2;
		DATASTORE_COLUMNS = 3;
		BIG_QUERY_COLUMNS = 4;
		ALL_COLUMNS = 5;
	}

	oneof type {
		google.privacy.dlp.v2.BigQueryTable table = 1;
	}
	OutputSchema output_schema = 3;
}

message InfoTypeStats {

	google.privacy.dlp.v2.InfoType info_type = 1;
	int64 count = 2;
}

message InspectDataSourceDetails {

	message RequestedOptions {

		InspectTemplate snapshot_inspect_template = 1;
		InspectJobConfig job_config = 3;
	}

	message Result {

		int64 processed_bytes = 1;
		int64 total_estimated_bytes = 2;
		repeated InfoTypeStats info_type_stats = 3;
		HybridInspectStatistics hybrid_stats = 7;
	}

	RequestedOptions requested_options = 2;
	Result result = 3;
}

message HybridInspectStatistics {

	int64 processed_count = 1;
	int64 aborted_count = 2;
	int64 pending_count = 3;
}

message InfoTypeDescription {

	string name = 1;
	string display_name = 2;
	repeated InfoTypeSupportedBy supported_by = 3;
	string description = 4;
}

message ListInfoTypesRequest {

	string parent = 4;
	string language_code = 1;
	string filter = 2;
	string location_id = 3;
}

message ListInfoTypesResponse {

	repeated InfoTypeDescription info_types = 1;
}

message RiskAnalysisJobConfig {

	PrivacyMetric privacy_metric = 1;
	google.privacy.dlp.v2.BigQueryTable source_table = 2;
	repeated Action actions = 3;
}

message QuasiId {

	google.privacy.dlp.v2.FieldId field = 1 [
		(google.api.field_behavior) = REQUIRED
	];
	oneof tag {
		google.privacy.dlp.v2.InfoType info_type = 2;
		string custom_tag = 3;
		google.protobuf.Empty inferred = 4;
	}
}

message StatisticalTable {

	message QuasiIdentifierField {

		google.privacy.dlp.v2.FieldId field = 1;
		string custom_tag = 2;
	}

	google.privacy.dlp.v2.BigQueryTable table = 3 [
		(google.api.field_behavior) = REQUIRED
	];
	repeated QuasiIdentifierField quasi_ids = 1 [
		(google.api.field_behavior) = REQUIRED
	];
	google.privacy.dlp.v2.FieldId relative_frequency = 2 [
		(google.api.field_behavior) = REQUIRED
	];
}

message PrivacyMetric {

	message NumericalStatsConfig {

		google.privacy.dlp.v2.FieldId field = 1;
	}

	message CategoricalStatsConfig {

		google.privacy.dlp.v2.FieldId field = 1;
	}

	message KAnonymityConfig {

		repeated google.privacy.dlp.v2.FieldId quasi_ids = 1;
		google.privacy.dlp.v2.EntityId entity_id = 2;
	}

	message LDiversityConfig {

		repeated google.privacy.dlp.v2.FieldId quasi_ids = 1;
		google.privacy.dlp.v2.FieldId sensitive_attribute = 2;
	}

	message KMapEstimationConfig {

		message TaggedField {

			google.privacy.dlp.v2.FieldId field = 1 [
				(google.api.field_behavior) = REQUIRED
			];
			oneof tag {
				google.privacy.dlp.v2.InfoType info_type = 2;
				string custom_tag = 3;
				google.protobuf.Empty inferred = 4;
			}
		}

		message AuxiliaryTable {

			message QuasiIdField {

				google.privacy.dlp.v2.FieldId field = 1;
				string custom_tag = 2;
			}

			google.privacy.dlp.v2.BigQueryTable table = 3 [
				(google.api.field_behavior) = REQUIRED
			];
			repeated QuasiIdField quasi_ids = 1 [
				(google.api.field_behavior) = REQUIRED
			];
			google.privacy.dlp.v2.FieldId relative_frequency = 2 [
				(google.api.field_behavior) = REQUIRED
			];
		}

		repeated TaggedField quasi_ids = 1 [
			(google.api.field_behavior) = REQUIRED
		];
		string region_code = 2;
		repeated AuxiliaryTable auxiliary_tables = 3;
	}

	message DeltaPresenceEstimationConfig {

		repeated QuasiId quasi_ids = 1 [
			(google.api.field_behavior) = REQUIRED
		];
		string region_code = 2;
		repeated StatisticalTable auxiliary_tables = 3;
	}

	oneof type {
		NumericalStatsConfig numerical_stats_config = 1;
		CategoricalStatsConfig categorical_stats_config = 2;
		KAnonymityConfig k_anonymity_config = 3;
		LDiversityConfig l_diversity_config = 4;
		KMapEstimationConfig k_map_estimation_config = 5;
		DeltaPresenceEstimationConfig delta_presence_estimation_config = 6;
	}
}

message AnalyzeDataSourceRiskDetails {

	message NumericalStatsResult {

		Value min_value = 1;
		Value max_value = 2;
		repeated Value quantile_values = 4;
	}

	message CategoricalStatsResult {

		message CategoricalStatsHistogramBucket {

			int64 value_frequency_lower_bound = 1;
			int64 value_frequency_upper_bound = 2;
			int64 bucket_size = 3;
			repeated ValueFrequency bucket_values = 4;
			int64 bucket_value_count = 5;
		}

		repeated CategoricalStatsHistogramBucket value_frequency_histogram_buckets = 5;
	}

	message KAnonymityResult {

		message KAnonymityEquivalenceClass {

			repeated Value quasi_ids_values = 1;
			int64 equivalence_class_size = 2;
		}

		message KAnonymityHistogramBucket {

			int64 equivalence_class_size_lower_bound = 1;
			int64 equivalence_class_size_upper_bound = 2;
			int64 bucket_size = 3;
			repeated KAnonymityEquivalenceClass bucket_values = 4;
			int64 bucket_value_count = 5;
		}

		repeated KAnonymityHistogramBucket equivalence_class_histogram_buckets = 5;
	}

	message LDiversityResult {

		message LDiversityEquivalenceClass {

			repeated Value quasi_ids_values = 1;
			int64 equivalence_class_size = 2;
			int64 num_distinct_sensitive_values = 3;
			repeated ValueFrequency top_sensitive_values = 4;
		}

		message LDiversityHistogramBucket {

			int64 sensitive_value_frequency_lower_bound = 1;
			int64 sensitive_value_frequency_upper_bound = 2;
			int64 bucket_size = 3;
			repeated LDiversityEquivalenceClass bucket_values = 4;
			int64 bucket_value_count = 5;
		}

		repeated LDiversityHistogramBucket sensitive_value_frequency_histogram_buckets = 5;
	}

	message KMapEstimationResult {

		message KMapEstimationQuasiIdValues {

			repeated Value quasi_ids_values = 1;
			int64 estimated_anonymity = 2;
		}

		message KMapEstimationHistogramBucket {

			int64 min_anonymity = 1;
			int64 max_anonymity = 2;
			int64 bucket_size = 5;
			repeated KMapEstimationQuasiIdValues bucket_values = 6;
			int64 bucket_value_count = 7;
		}

		repeated KMapEstimationHistogramBucket k_map_estimation_histogram = 1;
	}

	message DeltaPresenceEstimationResult {

		message DeltaPresenceEstimationQuasiIdValues {

			repeated Value quasi_ids_values = 1;
			double estimated_probability = 2;
		}

		message DeltaPresenceEstimationHistogramBucket {

			double min_probability = 1;
			double max_probability = 2;
			int64 bucket_size = 5;
			repeated DeltaPresenceEstimationQuasiIdValues bucket_values = 6;
			int64 bucket_value_count = 7;
		}

		repeated DeltaPresenceEstimationHistogramBucket delta_presence_estimation_histogram = 1;
	}

	message RequestedRiskAnalysisOptions {

		RiskAnalysisJobConfig job_config = 1;
	}

	PrivacyMetric requested_privacy_metric = 1;
	google.privacy.dlp.v2.BigQueryTable requested_source_table = 2;
	oneof result {
		NumericalStatsResult numerical_stats_result = 3;
		CategoricalStatsResult categorical_stats_result = 4;
		KAnonymityResult k_anonymity_result = 5;
		LDiversityResult l_diversity_result = 6;
		KMapEstimationResult k_map_estimation_result = 7;
		DeltaPresenceEstimationResult delta_presence_estimation_result = 9;
	}
	RequestedRiskAnalysisOptions requested_options = 10;
}

message ValueFrequency {

	Value value = 1;
	int64 count = 2;
}

message Value {

	oneof type {
		int64 integer_value = 1;
		double float_value = 2;
		string string_value = 3;
		bool boolean_value = 4;
		google.protobuf.Timestamp timestamp_value = 5;
		google.type.TimeOfDay time_value = 6;
		google.type.Date date_value = 7;
		google.type.DayOfWeek day_of_week_value = 8;
	}
}

message QuoteInfo {

	oneof parsed_quote {
		DateTime date_time = 2;
	}
}

message DateTime {

	message TimeZone {

		int32 offset_minutes = 1;
	}

	google.type.Date date = 1;
	google.type.DayOfWeek day_of_week = 2;
	google.type.TimeOfDay time = 3;
	TimeZone time_zone = 4;
}

message DeidentifyConfig {

	oneof transformation {
		InfoTypeTransformations info_type_transformations = 1;
		RecordTransformations record_transformations = 2;
	}
	TransformationErrorHandling transformation_error_handling = 3;
}

message TransformationErrorHandling {

	message ThrowError {

	}

	message LeaveUntransformed {

	}

	oneof mode {
		ThrowError throw_error = 1;
		LeaveUntransformed leave_untransformed = 2;
	}
}

message PrimitiveTransformation {

	oneof transformation {
		ReplaceValueConfig replace_config = 1;
		RedactConfig redact_config = 2;
		CharacterMaskConfig character_mask_config = 3;
		CryptoReplaceFfxFpeConfig crypto_replace_ffx_fpe_config = 4;
		FixedSizeBucketingConfig fixed_size_bucketing_config = 5;
		BucketingConfig bucketing_config = 6;
		ReplaceWithInfoTypeConfig replace_with_info_type_config = 7;
		TimePartConfig time_part_config = 8;
		CryptoHashConfig crypto_hash_config = 9;
		DateShiftConfig date_shift_config = 11;
		CryptoDeterministicConfig crypto_deterministic_config = 12;
	}
}

message TimePartConfig {

	enum TimePart {

		TIME_PART_UNSPECIFIED = 0;
		YEAR = 1;
		MONTH = 2;
		DAY_OF_MONTH = 3;
		DAY_OF_WEEK = 4;
		WEEK_OF_YEAR = 5;
		HOUR_OF_DAY = 6;
	}

	TimePart part_to_extract = 1;
}

message CryptoHashConfig {

	CryptoKey crypto_key = 1;
}

message CryptoDeterministicConfig {

	CryptoKey crypto_key = 1;
	google.privacy.dlp.v2.InfoType surrogate_info_type = 2;
	google.privacy.dlp.v2.FieldId context = 3;
}

message ReplaceValueConfig {

	Value new_value = 1;
}

message ReplaceWithInfoTypeConfig {

}

message RedactConfig {

}

message CharsToIgnore {

	enum CommonCharsToIgnore {

		COMMON_CHARS_TO_IGNORE_UNSPECIFIED = 0;
		NUMERIC = 1;
		ALPHA_UPPER_CASE = 2;
		ALPHA_LOWER_CASE = 3;
		PUNCTUATION = 4;
		WHITESPACE = 5;
	}

	oneof characters {
		string characters_to_skip = 1;
		CommonCharsToIgnore common_characters_to_ignore = 2;
	}
}

message CharacterMaskConfig {

	string masking_character = 1;
	int32 number_to_mask = 2;
	bool reverse_order = 3;
	repeated CharsToIgnore characters_to_ignore = 4;
}

message FixedSizeBucketingConfig {

	Value lower_bound = 1 [
		(google.api.field_behavior) = REQUIRED
	];
	Value upper_bound = 2 [
		(google.api.field_behavior) = REQUIRED
	];
	double bucket_size = 3 [
		(google.api.field_behavior) = REQUIRED
	];
}

message BucketingConfig {

	message Bucket {

		Value min = 1;
		Value max = 2;
		Value replacement_value = 3 [
			(google.api.field_behavior) = REQUIRED
		];
	}

	repeated Bucket buckets = 1;
}

message CryptoReplaceFfxFpeConfig {

	enum FfxCommonNativeAlphabet {

		FFX_COMMON_NATIVE_ALPHABET_UNSPECIFIED = 0;
		NUMERIC = 1;
		HEXADECIMAL = 2;
		UPPER_CASE_ALPHA_NUMERIC = 3;
		ALPHA_NUMERIC = 4;
	}

	CryptoKey crypto_key = 1 [
		(google.api.field_behavior) = REQUIRED
	];
	google.privacy.dlp.v2.FieldId context = 2;
	oneof alphabet {
		FfxCommonNativeAlphabet common_alphabet = 4;
		string custom_alphabet = 5;
		int32 radix = 6;
	}
	google.privacy.dlp.v2.InfoType surrogate_info_type = 8;
}

message CryptoKey {

	oneof source {
		TransientCryptoKey transient = 1;
		UnwrappedCryptoKey unwrapped = 2;
		KmsWrappedCryptoKey kms_wrapped = 3;
	}
}

message TransientCryptoKey {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
	];
}

message UnwrappedCryptoKey {

	bytes key = 1 [
		(google.api.field_behavior) = REQUIRED
	];
}

message KmsWrappedCryptoKey {

	bytes wrapped_key = 1 [
		(google.api.field_behavior) = REQUIRED
	];
	string crypto_key_name = 2 [
		(google.api.field_behavior) = REQUIRED
	];
}

message DateShiftConfig {

	int32 upper_bound_days = 1 [
		(google.api.field_behavior) = REQUIRED
	];
	int32 lower_bound_days = 2 [
		(google.api.field_behavior) = REQUIRED
	];
	google.privacy.dlp.v2.FieldId context = 3;
	oneof method {
		CryptoKey crypto_key = 4;
	}
}

message InfoTypeTransformations {

	message InfoTypeTransformation {

		repeated google.privacy.dlp.v2.InfoType info_types = 1;
		PrimitiveTransformation primitive_transformation = 2 [
			(google.api.field_behavior) = REQUIRED
		];
	}

	repeated InfoTypeTransformation transformations = 1 [
		(google.api.field_behavior) = REQUIRED
	];
}

message FieldTransformation {

	repeated google.privacy.dlp.v2.FieldId fields = 1 [
		(google.api.field_behavior) = REQUIRED
	];
	RecordCondition condition = 3;
	oneof transformation {
		PrimitiveTransformation primitive_transformation = 4;
		InfoTypeTransformations info_type_transformations = 5;
	}
}

message RecordTransformations {

	repeated FieldTransformation field_transformations = 1;
	repeated RecordSuppression record_suppressions = 2;
}

message RecordSuppression {

	RecordCondition condition = 1;
}

message RecordCondition {

	message Condition {

		google.privacy.dlp.v2.FieldId field = 1 [
			(google.api.field_behavior) = REQUIRED
		];
		RelationalOperator operator = 3 [
			(google.api.field_behavior) = REQUIRED
		];
		Value value = 4;
	}

	message Conditions {

		repeated Condition conditions = 1;
	}

	message Expressions {

		enum LogicalOperator {

			LOGICAL_OPERATOR_UNSPECIFIED = 0;
			AND = 1;
		}

		LogicalOperator logical_operator = 1;
		oneof type {
			Conditions conditions = 3;
		}
	}

	Expressions expressions = 3;
}

message TransformationOverview {

	int64 transformed_bytes = 2;
	repeated TransformationSummary transformation_summaries = 3;
}

message TransformationSummary {

	message SummaryResult {

		int64 count = 1;
		TransformationResultCode code = 2;
		string details = 3;
	}

	enum TransformationResultCode {

		TRANSFORMATION_RESULT_CODE_UNSPECIFIED = 0;
		SUCCESS = 1;
		ERROR = 2;
	}

	google.privacy.dlp.v2.InfoType info_type = 1;
	google.privacy.dlp.v2.FieldId field = 2;
	PrimitiveTransformation transformation = 3;
	repeated FieldTransformation field_transformations = 5;
	RecordSuppression record_suppress = 6;
	repeated SummaryResult results = 4;
	int64 transformed_bytes = 7;
}

message Schedule {

	oneof option {
		google.protobuf.Duration recurrence_period_duration = 1;
	}
}

message Manual {

}

message InspectTemplate {
	option (google.api.resource) = {
		type: "dlp.googleapis.com/InspectTemplate"
		pattern: ["organizations/{organization}/inspectTemplates/{inspect_template}","projects/{project}/inspectTemplates/{inspect_template}","organizations/{organization}/locations/{location}/inspectTemplates/{inspect_template}","projects/{project}/locations/{location}/inspectTemplates/{inspect_template}"]
	};

	string name = 1 [
		(google.api.field_behavior) = OUTPUT_ONLY
	];
	string display_name = 2;
	string description = 3;
	google.protobuf.Timestamp create_time = 4 [
		(google.api.field_behavior) = OUTPUT_ONLY
	];
	google.protobuf.Timestamp update_time = 5 [
		(google.api.field_behavior) = OUTPUT_ONLY
	];
	InspectConfig inspect_config = 6;
}

message DeidentifyTemplate {
	option (google.api.resource) = {
		type: "dlp.googleapis.com/DeidentifyTemplate"
		pattern: ["organizations/{organization}/deidentifyTemplates/{deidentify_template}","projects/{project}/deidentifyTemplates/{deidentify_template}","organizations/{organization}/locations/{location}/deidentifyTemplates/{deidentify_template}","projects/{project}/locations/{location}/deidentifyTemplates/{deidentify_template}"]
	};

	string name = 1 [
		(google.api.field_behavior) = OUTPUT_ONLY
	];
	string display_name = 2;
	string description = 3;
	google.protobuf.Timestamp create_time = 4 [
		(google.api.field_behavior) = OUTPUT_ONLY
	];
	google.protobuf.Timestamp update_time = 5 [
		(google.api.field_behavior) = OUTPUT_ONLY
	];
	DeidentifyConfig deidentify_config = 6;
}

message Error {

	google.rpc.Status details = 1;
	repeated google.protobuf.Timestamp timestamps = 2;
}

message JobTrigger {
	option (google.api.resource) = {
		type: "dlp.googleapis.com/JobTrigger"
		pattern: ["projects/{project}/jobTriggers/{job_trigger}","projects/{project}/locations/{location}/jobTriggers/{job_trigger}"]
	};

	message Trigger {

		oneof trigger {
			Schedule schedule = 1;
			Manual manual = 2;
		}
	}

	enum Status {

		STATUS_UNSPECIFIED = 0;
		HEALTHY = 1;
		PAUSED = 2;
		CANCELLED = 3;
	}

	string name = 1;
	string display_name = 2;
	string description = 3;
	oneof job {
		InspectJobConfig inspect_job = 4;
	}
	repeated Trigger triggers = 5;
	repeated Error errors = 6 [
		(google.api.field_behavior) = OUTPUT_ONLY
	];
	google.protobuf.Timestamp create_time = 7 [
		(google.api.field_behavior) = OUTPUT_ONLY
	];
	google.protobuf.Timestamp update_time = 8 [
		(google.api.field_behavior) = OUTPUT_ONLY
	];
	google.protobuf.Timestamp last_run_time = 9 [
		(google.api.field_behavior) = OUTPUT_ONLY
	];
	Status status = 10 [
		(google.api.field_behavior) = REQUIRED
	];
}

message Action {

	message SaveFindings {

		OutputStorageConfig output_config = 1;
	}

	message PublishToPubSub {

		string topic = 1;
	}

	message PublishSummaryToCscc {

	}

	message PublishFindingsToCloudDataCatalog {

	}

	message JobNotificationEmails {

	}

	message PublishToStackdriver {

	}

	oneof action {
		SaveFindings save_findings = 1;
		PublishToPubSub pub_sub = 2;
		PublishSummaryToCscc publish_summary_to_cscc = 3;
		PublishFindingsToCloudDataCatalog publish_findings_to_cloud_data_catalog = 5;
		JobNotificationEmails job_notification_emails = 8;
		PublishToStackdriver publish_to_stackdriver = 9;
	}
}

message CreateInspectTemplateRequest {

	string parent = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/InspectTemplate"
		}
	];
	InspectTemplate inspect_template = 2 [
		(google.api.field_behavior) = REQUIRED
	];
	string template_id = 3;
	string location_id = 4;
}

message UpdateInspectTemplateRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/InspectTemplate"
		}
	];
	InspectTemplate inspect_template = 2;
	google.protobuf.FieldMask update_mask = 3;
}

message GetInspectTemplateRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/InspectTemplate"
		}
	];
}

message ListInspectTemplatesRequest {

	string parent = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/InspectTemplate"
		}
	];
	string page_token = 2;
	int32 page_size = 3;
	string order_by = 4;
	string location_id = 5;
}

message ListInspectTemplatesResponse {

	repeated InspectTemplate inspect_templates = 1;
	string next_page_token = 2;
}

message DeleteInspectTemplateRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/InspectTemplate"
		}
	];
}

message CreateJobTriggerRequest {

	string parent = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/JobTrigger"
		}
	];
	JobTrigger job_trigger = 2 [
		(google.api.field_behavior) = REQUIRED
	];
	string trigger_id = 3;
	string location_id = 4;
}

message ActivateJobTriggerRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/JobTrigger"
		}
	];
}

message UpdateJobTriggerRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/JobTrigger"
		}
	];
	JobTrigger job_trigger = 2;
	google.protobuf.FieldMask update_mask = 3;
}

message GetJobTriggerRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/JobTrigger"
		}
	];
}

message CreateDlpJobRequest {

	string parent = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/DlpJob"
		}
	];
	oneof job {
		InspectJobConfig inspect_job = 2;
		RiskAnalysisJobConfig risk_job = 3;
	}
	string job_id = 4;
	string location_id = 5;
}

message ListJobTriggersRequest {

	string parent = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/JobTrigger"
		}
	];
	string page_token = 2;
	int32 page_size = 3;
	string order_by = 4;
	string filter = 5;
	string location_id = 7;
}

message ListJobTriggersResponse {

	repeated JobTrigger job_triggers = 1;
	string next_page_token = 2;
}

message DeleteJobTriggerRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/JobTrigger"
		}
	];
}

message InspectJobConfig {

	google.privacy.dlp.v2.StorageConfig storage_config = 1;
	InspectConfig inspect_config = 2;
	string inspect_template_name = 3;
	repeated Action actions = 4;
}

message DlpJob {
	option (google.api.resource) = {
		type: "dlp.googleapis.com/DlpJob"
		pattern: ["projects/{project}/dlpJobs/{dlp_job}","projects/{project}/locations/{location}/dlpJobs/{dlp_job}"]
	};

	enum JobState {

		JOB_STATE_UNSPECIFIED = 0;
		PENDING = 1;
		RUNNING = 2;
		DONE = 3;
		CANCELED = 4;
		FAILED = 5;
		ACTIVE = 6;
	}

	string name = 1;
	DlpJobType type = 2;
	JobState state = 3;
	oneof details {
		AnalyzeDataSourceRiskDetails risk_details = 4;
		InspectDataSourceDetails inspect_details = 5;
	}
	google.protobuf.Timestamp create_time = 6;
	google.protobuf.Timestamp start_time = 7;
	google.protobuf.Timestamp end_time = 8;
	string job_trigger_name = 10;
	repeated Error errors = 11;
}

message GetDlpJobRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/DlpJob"
		}
	];
}

message ListDlpJobsRequest {

	string parent = 4 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/DlpJob"
		}
	];
	string filter = 1;
	int32 page_size = 2;
	string page_token = 3;
	DlpJobType type = 5;
	string order_by = 6;
	string location_id = 7;
}

message ListDlpJobsResponse {

	repeated DlpJob jobs = 1;
	string next_page_token = 2;
}

message CancelDlpJobRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/DlpJob"
		}
	];
}

message FinishDlpJobRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/DlpJob"
		}
	];
}

message DeleteDlpJobRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/DlpJob"
		}
	];
}

message CreateDeidentifyTemplateRequest {

	string parent = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/DeidentifyTemplate"
		}
	];
	DeidentifyTemplate deidentify_template = 2 [
		(google.api.field_behavior) = REQUIRED
	];
	string template_id = 3;
	string location_id = 4;
}

message UpdateDeidentifyTemplateRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/DeidentifyTemplate"
		}
	];
	DeidentifyTemplate deidentify_template = 2;
	google.protobuf.FieldMask update_mask = 3;
}

message GetDeidentifyTemplateRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/DeidentifyTemplate"
		}
	];
}

message ListDeidentifyTemplatesRequest {

	string parent = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/DeidentifyTemplate"
		}
	];
	string page_token = 2;
	int32 page_size = 3;
	string order_by = 4;
	string location_id = 5;
}

message ListDeidentifyTemplatesResponse {

	repeated DeidentifyTemplate deidentify_templates = 1;
	string next_page_token = 2;
}

message DeleteDeidentifyTemplateRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/DeidentifyTemplate"
		}
	];
}

message LargeCustomDictionaryConfig {

	google.privacy.dlp.v2.CloudStoragePath output_path = 1;
	oneof source {
		google.privacy.dlp.v2.CloudStorageFileSet cloud_storage_file_set = 2;
		google.privacy.dlp.v2.BigQueryField big_query_field = 3;
	}
}

message LargeCustomDictionaryStats {

	int64 approx_num_phrases = 1;
}

message StoredInfoTypeConfig {

	string display_name = 1;
	string description = 2;
	oneof type {
		LargeCustomDictionaryConfig large_custom_dictionary = 3;
		google.privacy.dlp.v2.CustomInfoType.Dictionary dictionary = 4;
		google.privacy.dlp.v2.CustomInfoType.Regex regex = 5;
	}
}

message StoredInfoTypeStats {

	oneof type {
		LargeCustomDictionaryStats large_custom_dictionary = 1;
	}
}

message StoredInfoTypeVersion {

	StoredInfoTypeConfig config = 1;
	google.protobuf.Timestamp create_time = 2;
	StoredInfoTypeState state = 3;
	repeated Error errors = 4;
	StoredInfoTypeStats stats = 5;
}

message StoredInfoType {
	option (google.api.resource) = {
		type: "dlp.googleapis.com/StoredInfoType"
		pattern: ["organizations/{organization}/storedInfoTypes/{stored_info_type}","projects/{project}/storedInfoTypes/{stored_info_type}","organizations/{organization}/locations/{location}/storedInfoTypes/{stored_info_type}","projects/{project}/locations/{location}/storedInfoTypes/{stored_info_type}"]
	};

	string name = 1;
	StoredInfoTypeVersion current_version = 2;
	repeated StoredInfoTypeVersion pending_versions = 3;
}

message CreateStoredInfoTypeRequest {

	string parent = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/StoredInfoType"
		}
	];
	StoredInfoTypeConfig config = 2 [
		(google.api.field_behavior) = REQUIRED
	];
	string stored_info_type_id = 3;
	string location_id = 4;
}

message UpdateStoredInfoTypeRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/StoredInfoType"
		}
	];
	StoredInfoTypeConfig config = 2;
	google.protobuf.FieldMask update_mask = 3;
}

message GetStoredInfoTypeRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/StoredInfoType"
		}
	];
}

message ListStoredInfoTypesRequest {

	string parent = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			child_type: "dlp.googleapis.com/StoredInfoType"
		}
	];
	string page_token = 2;
	int32 page_size = 3;
	string order_by = 4;
	string location_id = 5;
}

message ListStoredInfoTypesResponse {

	repeated StoredInfoType stored_info_types = 1;
	string next_page_token = 2;
}

message DeleteStoredInfoTypeRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/StoredInfoType"
		}
	];
}

message HybridInspectJobTriggerRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/JobTrigger"
		}
	];
	HybridContentItem hybrid_item = 3;
}

message HybridInspectDlpJobRequest {

	string name = 1 [
		(google.api.field_behavior) = REQUIRED
		(google.api.resource_reference) = {
			type: "dlp.googleapis.com/DlpJob"
		}
	];
	HybridContentItem hybrid_item = 3;
}

message HybridContentItem {

	ContentItem item = 1;
	HybridFindingDetails finding_details = 2;
}

message HybridFindingDetails {

	Container container_details = 1;
	int64 file_offset = 2;
	int64 row_offset = 3;
	google.privacy.dlp.v2.TableOptions table_options = 4;
	map<string, string> labels = 5;
}

message HybridInspectResponse {

}
