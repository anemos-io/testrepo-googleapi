syntax = "proto3";

package grafeas.v1beta1.vulnerability;

import "google/protobuf/timestamp.proto";
import "google/devtools/containeranalysis/v1beta1/common/common.proto";
import "google/devtools/containeranalysis/v1beta1/cvss/cvss.proto";
import "google/devtools/containeranalysis/v1beta1/package/package.proto";

option java_package = "io.grafeas.v1beta1.vulnerability";
option java_multiple_files = true;
option go_package = "google.golang.org/genproto/googleapis/devtools/containeranalysis/v1beta1/vulnerability;vulnerability";
option objc_class_prefix = "GRA";


enum Severity {

	SEVERITY_UNSPECIFIED = 0;
	MINIMAL = 1;
	LOW = 2;
	MEDIUM = 3;
	HIGH = 4;
	CRITICAL = 5;
}

message Vulnerability {

	message Detail {

		string cpe_uri = 1;
		string package = 2;
		grafeas.v1beta1.package.Version min_affected_version = 3;
		grafeas.v1beta1.package.Version max_affected_version = 4;
		string severity_name = 5;
		string description = 6;
		VulnerabilityLocation fixed_location = 7;
		string package_type = 8;
		bool is_obsolete = 9;
		google.protobuf.Timestamp source_update_time = 10;
	}

	message WindowsDetail {

		message KnowledgeBase {

			string name = 1;
			string url = 2;
		}

		string cpe_uri = 1;
		string name = 2;
		string description = 3;
		repeated KnowledgeBase fixing_kbs = 4;
	}

	float cvss_score = 1;
	Severity severity = 2;
	repeated Detail details = 3;
	grafeas.v1beta1.vulnerability.CVSSv3 cvss_v3 = 4;
	repeated WindowsDetail windows_details = 5;
	google.protobuf.Timestamp source_update_time = 6;
}

message Details {

	string type = 1;
	Severity severity = 2;
	float cvss_score = 3;
	repeated PackageIssue package_issue = 4;
	string short_description = 5;
	string long_description = 6;
	repeated grafeas.v1beta1.RelatedUrl related_urls = 7;
	Severity effective_severity = 8;
}

message PackageIssue {

	VulnerabilityLocation affected_location = 1;
	VulnerabilityLocation fixed_location = 2;
	string severity_name = 3;
}

message VulnerabilityLocation {

	string cpe_uri = 1;
	string package = 2;
	grafeas.v1beta1.package.Version version = 3;
}
